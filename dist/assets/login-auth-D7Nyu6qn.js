import{f as s}from"./fetch-CIEPykbw.js";const u=document.querySelector(".createuser");u.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt luodaan käyttäjä");const t="https://longway.northeurope.cloudapp.azure.com/api/users",o=document.querySelector(".create_user_form"),a={username:o.querySelector("input[name=username]").value,password:o.querySelector("input[name=password]").value,email:o.querySelector("input[name=email]").value},e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};s(t,e).then(c=>{console.log(c),alert("Luodaan uusi käyttäjä")})});const i=document.querySelector(".loginuser");i.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt logataan sisään");const t="https://longway.northeurope.cloudapp.azure.com/api/auth/login",o=document.querySelector(".login_form"),r={username:o.querySelector("input[name=username]").value,password:o.querySelector("input[name=password]").value},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};s(t,a).then(e=>{console.log(e),console.log(e.token),localStorage.setItem("token",e.token),e.token==null?alert("Unauthorized user: käyttäjänimi tai salasana vihreellinen"):(alert(e.message),localStorage.setItem("name",e.user.username),localStorage.setItem("user_id",e.user.user_id),window.location.href="diary.html"),l("loginResponse",`localStorage set with token value: ${e.token}`)})});const m=document.querySelector("#meRequest");m.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const n="https://longway.northeurope.cloudapp.azure.com/api/auth/me",t=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",t);const o={method:"GET",headers:{Authorization:"Bearer: "+t}};console.log(o),s(n,o).then(r=>{console.log(r),l("meResponse",`Authorized user info: ${JSON.stringify(r)}`)})});const p=document.querySelector("#clearButton");p.addEventListener("click",d);function l(n,t){document.getElementById(n).innerText=t}function d(){localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")}
